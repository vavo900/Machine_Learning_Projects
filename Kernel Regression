{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Kernel Regression\n",
    "\n",
    "Given a training dataset $\\{x_i, y_i\\}_{i=1}^n$, kernel regression approximates the unknown\n",
    "nolinear relation between $x$ and $y$ with a function of form\n",
    "$$\n",
    "y\\approx f(x;w) = \\sum_{i=1}^n w_i k(x, x_i),\n",
    "$$\n",
    "where $k(x, x')$ is a positive definite kernel specified by the users, and ${w_i}$ is a\n",
    "set of weights.\n",
    "We will use the simple Gaussian radius basis funciton (RBF) kernel,\n",
    "$$\n",
    "k(x, x') = exp(-\\frac{||x-x'||^2}{2h^2}),\n",
    "$$\n",
    "where $h$ is a bandwith parameter.\n",
    "\n",
    "\n",
    "### Step 1. Simulate a 1-dimensional dataset"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {
    "pycharm": {
     "name": "#%%\n"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "xTrain shape (100, 1) yTrain shape (100, 1)\n"
     ]
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "\n",
    "import numpy as np\n",
    "import matplotlib\n",
    "import matplotlib.pyplot as plt\n",
    "from scipy.spatial import distance\n",
    "import scipy\n",
    "import math\n",
    "%matplotlib inline\n",
    "\n",
    "np.random.seed(100)\n",
    "\n",
    "### Step 1: Simulate a simple 1D data ###\n",
    "xTrain = np.expand_dims(np.linspace(-5, 5, 100), 1)  # 100*1\n",
    "yTrain = np.sin(xTrain) + 0.5*np.random.uniform(-1, 1, size=xTrain.shape) ## 100 *1\n",
    "\n",
    "print('xTrain shape', xTrain.shape, 'yTrain shape', yTrain.shape)\n",
    "plt.plot(xTrain, yTrain, '*')\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Now we have a dataset with 100 training data points. Let us calculate the kernel function.\n",
    "\n",
    "### Step 2. Kernel function\n",
    "\n",
    "Your task is to complete the following rbf_kernel function that takes two sets of points $X$ (of size $n$) and $X'$ (of size $m$) and the bandwidth $h$ and ouputs their pairwise  kernel matrix $K = [k(x_i, x_j)]_{ij}$, which is of size $n\\times m$. We will represent input data as matrices, with $X=[x_i]_{i=1}^n \\in R^{n\\times 1}$ denoting the input features and $Y=[y_i]_{i=1}^n\\in R^{n\\times 1}$ the input labels.)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {
    "pycharm": {
     "name": "#%%\n"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[[0.60653066 1.         0.60653066]\n",
      " [0.13533528 0.60653066 1.        ]]\n"
     ]
    }
   ],
   "source": [
    "\"\"\"\n",
    "    calcuating kernel matrix between X and Xp\n",
    "\"\"\"\n",
    "def rbf_kernel(X, Xp, h):\n",
    "    # X: n*1 matrix\n",
    "    # Xp: m*1 matrix\n",
    "    # h: scalar value\n",
    "\n",
    "    ## TODO: please calculate the kernel matrix in the following:\n",
    "    # (hint: you can write your own pairwise distance function, or cipy.spatial.distance.cdist)\n",
    "    K = distance.cdist(X, Xp, 'euclidean')\n",
    "    K = np.exp(-1*(np.square(K)) / (2 * h ** 2))\n",
    "\n",
    "    return K #n*m\n",
    "\n",
    "\n",
    "\n",
    "### evaluation: if your implementation is correct, you should expect the output is a 2X3 matrix\n",
    "# [[0.60653066 1.         0.60653066]\n",
    "# [0.13533528 0.60653066 1.        ]]\n",
    "k_test = rbf_kernel(np.array([[2],[1]]), np.array([[3],[2],[1]]), 1)\n",
    "print(k_test)\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Step 3. The median trick for bandwith\n",
    "The choice of the bandwidth $h$\n",
    "A common way to set the bandwith $h$ in practice is the so called median trick,\n",
    "which sets $h$ to be the median of the pairwise distance on the training data, that is\n",
    "$$\n",
    "h_{med} = median(\\{||x_i - x_j||: i\\neq j, ~~~~~~i,j =1, ..., n\\}).\n",
    "$$\n",
    "\n",
    "- Task: Compelete the median distance function.\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {
    "pycharm": {
     "name": "#%%\n"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "2.0\n"
     ]
    }
   ],
   "source": [
    "from scipy.spatial import distance\n",
    "\n",
    "def median_distance(X):\n",
    "    # X: n*1 matrix\n",
    "\n",
    "    #TODO: Calculate the median of the pairwise distance of $X$ below\n",
    "    #(hint: use '[dist[i, j] for i in range(len(X)) for j in range(len(X)) if i != j]' to remove the diagonal terms; use np.median)\n",
    "    dist = distance.cdist(X, X, 'euclidean')\n",
    "    dist = [dist[i, j] for i in range(len(X)) for j in range(len(X)) if i != j]\n",
    "\n",
    "    h = np.median(dist)\n",
    "\n",
    "    return h\n",
    "\n",
    "\n",
    "### Test your functions\n",
    "#evaluation: if your implementation is correct, your answer should be [2.0]\n",
    "h_test = median_distance(np.array([[1],[2],[4]]))\n",
    "print(h_test)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Step 4. Kernel regression\n",
    "The weights ${w_i}$ are estimated by minimizing a regularized mean square error:\n",
    "$$\n",
    "\\min_w {\\left ( \\sum_{i=1}^n (y_i - f(x_i; w))^2 \\right) + \\beta w^\\top K w },\n",
    "$$\n",
    "where $w$ is the column vector formed by $w=[w_i]_{i=1}^n$ and K is the kernel matrix.\n",
    "\n",
    "- Please derive the optimal solution of $w$ using matrix inverseion (no need to show the work)\n",
    "\n",
    "- Complete the following function to implement the calculation of $w$"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {
    "pycharm": {
     "name": "#%%\n"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "(100, 1)\n"
     ]
    }
   ],
   "source": [
    "def kernel_regression_fitting(xTrain, yTrain, h, beta=1):\n",
    "    # X: input data, numpy array, n*1\n",
    "    # Y: input labels, numpy array, n*1\n",
    "\n",
    "\n",
    "    # TODO: calculate W below (it is a n*1 matrix)\n",
    "    K = rbf_kernel(xTrain, xTrain, h)\n",
    "    K = np.add(K, np.identity(K.shape[0]))\n",
    "    W = np.matmul(np.linalg.inv(K), yTrain)\n",
    "\n",
    "\n",
    "    return W\n",
    "\n",
    "### evaluating your code, the shape should be (100, 1) (check the values yourself)\n",
    "h = median_distance(xTrain)\n",
    "W_test = kernel_regression_fitting(xTrain, yTrain, h)\n",
    "print(W_test.shape)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Step 5. Evaluation and Cross Validation\n",
    "\n",
    "We now need to evaluate the algorithm on the testing data and select the hyperparameters (bandwidth and regularization coefficient) using cross validation"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {
    "pycharm": {
     "name": "#%%\n"
    }
   },
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# Please run and read the following base code\n",
    "\n",
    "def kernel_regression_fit_and_predict(xTrain, yTrain, xTest, h, beta):\n",
    "\n",
    "    #fitting on the training data\n",
    "    W = kernel_regression_fitting(xTrain, yTrain, h, beta)\n",
    "\n",
    "    # computing the kernel matrix between xTrain and xTest\n",
    "    K_xTrain_xTest = rbf_kernel(xTrain, xTest, h)\n",
    "\n",
    "    # predict the label of xTest\n",
    "    yPred = np.dot( K_xTrain_xTest.T, W)\n",
    "    return yPred\n",
    "\n",
    "# generate random testing data\n",
    "xTest = np.expand_dims(np.linspace(-6, 6, 200), 1) ## 200*1\n",
    "\n",
    "\n",
    "beta = 1.\n",
    "# calculating bandwith\n",
    "h_med = median_distance(xTrain)\n",
    "yHatk = kernel_regression_fit_and_predict(xTrain, yTrain, xTest, h_med, beta)\n",
    "\n",
    "\n",
    "# we also add linear regression for comparision\n",
    "from sklearn.linear_model import LinearRegression\n",
    "lr = LinearRegression()\n",
    "lr.fit(xTrain, yTrain)\n",
    "yHat = lr.predict(xTest) # prediction\n",
    "\n",
    "# visulization\n",
    "plt.plot(xTrain, yTrain, '*')\n",
    "plt.plot(xTest, yHat, '*')\n",
    "plt.plot(xTest, yHatk, '-k')\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Step 5.1. Impact of bandwith\n",
    "Run the kernel regression with regularization coefficient $\\beta=1$ and\n",
    "bandwidth $h \\in \\{ 0.1 h_{med}, h_{med}, 10h_{med}\\}$.\n",
    "\n",
    "- Task: Show the curve learned by different $h$. Comment on how $h$ influences the smoothness of $h$.\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {
    "pycharm": {
     "name": "#%%\n"
    }
   },
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 864x288 with 3 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "### fitting on the training data ###\n",
    "beta = 1.\n",
    "\n",
    "plt.figure(figsize=(12, 4))\n",
    "for i, coff in enumerate([0.1, 1., 10]):\n",
    "    plt.subplot(1, 3, i+1)\n",
    "\n",
    "    ### TODO: run kernel regression with bandwith h = coff * h_med.\n",
    "    h_med = median_distance(xTrain)\n",
    "    h = coff * h_med\n",
    "    yHatk_i = kernel_regression_fit_and_predict(xTrain, yTrain, xTest, h, beta)\n",
    "\n",
    "    # visulization\n",
    "    plt.plot(xTrain, yTrain, '*')\n",
    "    plt.plot(xTest, yHat, '*')\n",
    "    plt.plot(xTest, yHatk_i, '-k')\n",
    "    plt.title('handwidth {} x h_med'.format(coff))\n",
    "\n",
    "plt.show()\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Step 5.2. Cross Validation (CV)\n",
    "Use 5-fold cross validation to find the optimal combination of\n",
    "$h$ and $\\beta$ within $h\\in \\{0.1h_{med}, h_{med}, 10h_{med}\\}$ and $\\beta \\in \\{0.1, 1\\}$.\n",
    "- Task: complete the code of cross validation and find the best $h$ and $\\beta$. Plot the curve fit with the optimal hyperparameters."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {
    "pycharm": {
     "name": "#%%\n"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Beta beta 0.1 Best bandwith 0.1*h_med mse 0.1116622935589619\n"
     ]
    },
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAAXwAAAEICAYAAABcVE8dAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4xLjMsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy+AADFEAAAgAElEQVR4nO3deZyNdfvA8c81w2Ds+75EtkKRJWFQiZAsWVr0IBXSRjySSvKUytP266mkhZC1kD1GRFlCZM++M2MJM8z+/f1xzugYc86cM2c/c71fr3mZc+773Pf3HGeu+3tf302MMSillAp9Yf4ugFJKKd/QgK+UUjmEBnyllMohNOArpVQOoQFfKaVyCA34SimVQ2jAV0qpHEIDfggRkcMicq+/y+FNItJKRI4H8rlEJE5EqtrZ1kdE1nr6nJ4QiN+fQCxTMNOArwD3/7BEJI+IfC0il0TktIgMcbBvHRFZJiJnRSTkRv4ZYwoYYw46s6+IGBG5Obvn0s9duUIDvvKU0UB1oDLQGhguIu3s7JsMzAKe8E3RQtpo9HNXTtKAH3oaicguEbkgIt+ISN70DSLSUUS2isjfIvKbiNSzPj8FqAQssKYjhlufn22tNV4UkV9E5FYH530ceNMYc8EYsxuYCPTJbEdjzF5jzFfAzuy+SREZKiIxInJKRPraPN9BRP6w1niPichom21VrDXqf4nIUWtN9xWb7flEZJL1s9sFNLLZ1ldEFtg83i8is2weHxOR262/X6u1i0hxEfnRWp6NQDWb1/xi/XWb9XPvmdX7y4SnP/fbReRP6//5TNvvT2bSU1AiMtymvJ1FpL2I/CUi50VkpM3+YSIyQkQOiMg5EZklIsVstvcWkSPWba9kflaVbcYY/QmRH+AwsAOoCBQDfgXGWrc1AGKAJkA48C/r/nlsXntvhuP1AwoCeYAPga12zlsUMEBpm+ceArZnUd6bLV9Bl95jKyAFGAPkBtoDV4CiNtvrYqnM1APOAJ2t26pYyzkRyAfcBiQCta3bxwFrrJ9dRetnedy6rSrwt/W4ZYEjwAmbbReAMOtjA9xs/X0Gllp1fqAOcAJYa/N+ru3rzPvz5udu/Q5sBMpZP4PdwAAn/z9es5b3SSAW+M763bkVSACqWvd/AVgPVLB+ryYA063bbgHigCjrtvetx77XURn0x4W/H38XQH88+J9p+YMdYPO4PXDA+vtnWGqCtvvvBVravNbuHxZQxBpcCmeyraJ1W16b59oAh7Mob3YD/lUgl81zMcCddvb/EPjA+nsVazkr2GzfCPSy/n4QaGez7SmsAd/6+BiWC2cv4Avra2sBfYEfbfYz1vcWjiWNUstm21tkHfCden+e/tyt34HHbB6/C3zu5P9HuPVxQWuZmtjss5l/Lrq7gXtstpW1fka5sFw0Zthsyw8kacD33E8uVKg5ZvP7ESy1NbDkeP8lIs/abI+w2X4dEQkH/gN0B0oCadZNJYCLGXaPs/5bCEttLv33y9kovzPOGWNSbB5fAQoAiEgTLDX1OljeXx5gdobXn87stVg+i4yfn63VWALczdbf/wZaAk2tjzMqiSWQOTpmZuy+vwy88bln/Gwy/X5kcM4Yk2r9/ar13zM226/yT/krA3NFJM1meypQmgyfvzEmXkTOuVB2lQXN4Yeeija/VwJOWn8/BvzHGFPE5ifSGDPduj1jr41HgAeBe4HCWGrHAJLxhMaYC8ApLCmSdLfhRo7eDd8BPwIVjTGFgc/JpMx2nOLGz89WesBvYf19NZaA35LMA34slpSEo2NmW4B97s46Btyf4XuY1xhzggyfv4hEAsX9VdBQpAE/9DwjIhWsDWEjgZnW5ycCA0SkiVjktzZwFrRuP4MlF52uIJb89jkgEksqwpFvgVEiUlREamHJ5U7KbEfr+fNiqYEjInlFJI/N9kkikulrnVAQOG+MSRCRxlguXM6aBbxsfQ8VgGczbF+NpSdMPmPMcSz5/nZYgtIfGQ9mrfX+AIwWkUgRuQVL24mtjJ+7qzz2ufvI58B/RKSytQwlReRB67Y5QEcRaS4iEVjaMTRGeZB+mKHnO+AnLPnog8BYAGPMJizB4BMsDYz7ub43x9tYAsffIvISlkByBEsj4y4sDW2OvA4csL5mNfCeMWYpgIhUsvZCSa/dVsZym59eE72KpT0hXUUsDc7ZMQgYIyKXseSEZ2Wxv603rOU/hOUznGK70RjzF5Y0yhrr40tYPuNfbVIaGQ3Gks44jSUQf5Nh+2hgsvVz7+FCWdN58nP3hY+w3IH9ZP0/Wo+lIwHGmJ3AM1i+w6ewfE/9MggtVIm1cUSpgGCt2W0D6hljkv1dHqVCiQZ8pZTKITSlo5RySERGWlNDGX+W+LtsyjVaw1dKqRwioPvhlyhRwlSpUsXfxVBKqaCxefPms8aYkpltC+iAX6VKFTZt2uTvYiilVNAQEbuD+zSHr5RSOYRHAr5Y5uOOEZEddra3ss6+t9X685onzquUUsp5nkrpTMIyoOdbB/usMcZ09ND5lFJKucgjNXxjzC/AeU8cSymllHf4MoffVES2icgScbyQhlJKKS/wVcDfAlQ2xtwG/B8wz96OIvKUiGwSkU2xsbE+Kp5SoSPmUgI9Jqwj5nJC1jurHMUnAd8Yc8kYE2f9fTGQW0RK2Nn3C2NMQ2NMw5IlM+1KqpTKwDbIfxy9j98Pn+fjFfv8XSwVYHzSD19EygBnjDHGOmVtGJZpd5VSHvBx9D42HjpP4/9EX3tu6oajTN1wlDy5wtg79n4/lk4FCo8EfBGZjmVhiBIichzLlK25AYwxn2NZZ3OgiKRgmZK1l9E5HZRyW81RS0hMSct0W97cYbS9tQyvdKjt41KpQOWRgG+MeTiL7Z9g6baplPKgNcNbM3bxbn7aeZqE5DTCBVINROQKIzEljYJ5clGqYF5/F1MFCB1pq1QQK1UoLwXz5CIxJY08ucJINVCjVAHmDWrGo00qExuX6O8iqgAS0HPpKKWydjYukUebVOaRxpX4buNRYi8ncEu5QoztXMffRVMBJqCnR27YsKEJ1snTYi4lMHj6H3zySH29pVZK+YyIbDbGNMxsm6Z0vES7ximlAo2mdDwsY68J7RqnlAoUWsP3sDXDW9Pp9nLkzW35aPPmDuPB28ux5t+t/VwypVROpwHfwzL2mtCucUqpQKEpHS/IrNeEUkr5m/bSUUqpEKK9dAKYzmyolPIVDfh+pt03lVK+ojl8P9Hum0opX9Mavp9o902llK9pwPcT7b6plPI1Ten4kXbfVEr5knbLVEo5pBMBBhftlhnEtNum8jftSRY6NOD7ibOBXP/YlL/UHLWEKiMWMXXDUYyx9CSrMmIRNUct8XfRVDZpwPeTrAK5/rEpf9OeZKFHA76PORvI9Y9NucvddKD2JAs9GvB9zNlArn9syh5fpgPTe5LNta6Re/zCFW1TCmLaLdPHXAnk2m1TZcY2kI/tUveG7Z4cxT2h9z+dPcZ2rsOouduZtvGo3XOrwKbdMv3g6SmbKFkw73WB3PYPS6nMZAzk6TIG8phLCYxdvJufdp4mITmNvLnDaHtrGV7pUDvbd4jOnlv5n6NumVrD94OMtSalnLFmeGu7gdyWN9KBzp5bBTYN+EoFCX+mA7VNKTR4JOCLyNdARyDGGHNDlVVEBPgIaA9cAfoYY7Z44tz+oqMPlS+lf98iI8KdCuTeuIvUNqXg55EcvohEAXHAt3YCfnvgWSwBvwnwkTGmSVbHDeQcfnrj1aONK2njlfK6rL5vmzdvZvz48URERPDggw/StWtXP5RSBQJHOXyPNdqKSBVgoZ2APwFYZYyZbn28F2hljDnl6JiBGPC18Ur5kjPftylTpvDkk0+SP39+cufOzZkzZ5gwYQJPPfWUr4urAkAgzKVTHjhm8/i49bmgowOilC9l9X3bunUr/fr1o2nTpuzdu5fDhw/ToUMHnn76aaKjo/1ZdBWAfBXwJZPnMr21EJGnRGSTiGyKjY31crFcp41Xypccfd+SkpLo06cPxYsXZ86cOZQoUYK8efMyZ84cKleuzPDhw0lLu/HuQOVcvgr4x4GKNo8rACcz29EY84UxpqExpmHJkiV9UjhXZRx9GBuX6O8iqRBm7/v22WefsW3bNiZMmEDx4sWv7Z83b17GjBnDli1bmD17tr+KrQKQr3L4HYDB/NNo+7ExpnFWxwzEHL4j2nNH+UpCQgJVq1alZs2a/PzzzzdsT01N5fbbb8cYw/bt27F0lFM5gddz+CIyHVgH1BSR4yLyhIgMEJEB1l0WAweB/cBEYJAnzhtodCpj5Stff/01p06d4tVXX810e3h4OM899xw7d+5k48aNPi6dClQ6tYIHeLrnjt4pKEdSU1OpVq0a5cuXZ+3atXZr75cuXaJs2bI8+uijfPHFFz4upfKXQOilE9I83XNH7xSUI0uXLuXIkSMMGTLEYaqmUKFC9OjRgxkzZhAfH+/DEqpApVMreICneu54cpZDFbo+//xzypQpQ6dOnbLct1+/fkyaNInJ02exKrWW3jXmcFrD9xBP9NzRPv4qK0eOHGHRokX079+f3LlzZ7l/s2bNKFeuHB9NnKp3jUpr+J7iiblLtI+/AsdtON988w0A/fv3d+pYtV9bxuWyd3BqyzIqNBuod405nNbwA4wn7hTcXdpO+Ze9NhxjDFOmTOHuu++mcuXKTh1rzfDWtGnfCZOSxNWDm8mTSyieP4K5z9zljaKrAKc1/ADjiTuFrFZEUoEpqzac3377jYMHD/L66687fcxShfJSo15DwiKLkPDXryTWak5iShLfrT+q340cSAN+CNFG3+CW1SIjU6ZMITIy0uWZMM9fTSF/jabE7fyZosmJhOXOo9+NHEoDvoft2bOHpUuXcvbsWSIjI6lYsSKVK1emfPnypKSkcPToUf7880/+/PNPTp48SXJyMs2bN6d3797UrFnTrXPrqkTBLat5c2bOnEmXLl0oUKCAS8ed0Lsh9xZ8hh5dlpB6bCthVZvodyOH0oDvATGXEhj47QYiN3/L1ElfAxAWFuZw4qqyZctSpUoVUlNTefvttxk/fjxTp07loYceynY5tNE3+NlbZGTFihX8/fff9OrVK1vH7dzhPvIWKMTFXWspX6OpfjdyKA34HvDBsl0sencwicd28NJLLzF48GAqV67M1atXOXbsGEeOHOHEiRNERERQpkwZ6tati+3EcKdOneKhhx6iR48ezJw5k+7du2e7LLoqUXDL2IaT3gAfvmYGhQoVok2bNtk6bu7cualUvyVHNq9iZv9GzNl6Wr8bOZBOreCG9Jz532umcvG3GRRv/wIF6t6brbzo1atXad26Nfv372fXrl2UKlXKS6VWwWTU3O1MXXeAM58+Tveunfn222+zfaxFixbRsWNHFi9ezP33a94+VOnUCl6yZnhrGhc4z8V1s8hf5x5KNLgv2wOl8uXLx9dff83ly5d57rnnvFBaFUxqjlpClRGLmLrhKFcPbSMh/jJLr1Sh5qgl2T7mvffeS6FChZgzZ44HS6qCiQZ8N5QqlJdN339OWGQhyrQb6HZe9JZbbmHEiBHMnDmTP//808OlVcHEdtR1/N61hOWJpPuDHdwadZ0nTx4eeOAB5s+fT0pKigdLq4KFBnw3bN68mUNbf6Nl1z78+GIbjyyG8sILL5A/f37Gjx/voVKqYJTeAJ+QmMTVfevJd3MTihaIdLuRtVu3bpw7d47Vq1c7/Zr4+HhmzZrFrFmzOHPmzA3bdaBf8NCA74a3336bwoULM++TN7ilXCHGdq5zXaNbdhQtWpQnn3yS6dOnc+zYsaxfoELW2bhEmuY9RVpCHO0f7OqRldXatm1LZGQk33//vVP7nzx5khYtWtCzZ0969uxJkyZNOH369HX76OyuwUMDfjadOHGCuXPnMnDgQAoVKuTRY7/44osYY/j00089elwVXCb0bkjkid8pVKgQU1570u3KBEBkZCQdOnRgzpw5JCZaLiD2augXL16kRYsW7Nu3j9mzZ7NkyRJiY2Pp1KkTCQkJ17UzGGMZ6FdlxCK32hmUd2nAz6bvvvuOtLQ0+vXr5/FjV6pUiXbt2jF16lRSU1M9fnwVHJKTk5k7dy6dOnUiT548HjvuE088QWxs7LXGW3s19Oeee47Dhw+zZMkSHnroIdq1a8fkyZP5/fff+fyrydQuW4i2t5bW2V2DiAb8bDDGMHnyZJo2bUr16tW9co7HH3+c48ePZ7peqcoZoqOjuXDhgsNxGdnJn7dp04YaNWrQf/ibdmvos2bN4ttvv2XUqFE0b9782mu7detGnTp1GPffD9l67AIHY+N1oF8Q0YCfDVu3bmXnzp08/vjjXjtHp06dKFy4sFv9rlVwmz17NgULFuS+++6zu0928udhYWEMHjyYhJN7STy5l/Awy6pZ6TX0mY9V5+mnn6ZJkyaMGjXqutfWenUpJ8u34syhPSQc38W+mDiMgTRjPNJpQXmXBvxsmDFjBrly5aJHjx4uvc6V2ljevHnp2bMn33//vS5PlwMlJyczb948OnXqRN68N9aY3cmf1xy1hPcOliEsXyHOr/jiWhfNhOQ0IsMNLw58kuTkZKZOnXrDIitrhremR6+HCctbgMtbFl+7SPw64m6PdFpQ3qUBPxsWL15MVFQUxYoVc+l1rtbGHn74Ya5cucLixYuzU0wVxFauXMn58+ftpnPcWR1tzfDWdG5yM6XbDiDp1F7ifp9Lq5ol6Vq/LHM+HMWqVav49NNPufnmm294balCeSlWuCCRNe4i4eDvJCQmaRoniOhcOi46evQoO3bscKmffHanLW7RogWlS5dm9uzZbs2vo4LPrFmzKFiwIG3bts10uzsT5aW/NqJmC/LXWMP5VZP4Ne4ghdLi2L9lC3UefJp2XezfvZ6NS6Tt/e35/s+faFHoPLFx5bP9PpVvaQ3fRem17Q4dOjj9muzWxsLDw+natSuLFi3iypUrLpdVB8QEp6SkJH744Qc6d+6caTonnTuro52NS+SxO6uwevEPRPUaxNFdW0hNTaX9wNe5XKujw7vQCb0b8s0r/cidOzdlLu7SNE4Q0cnTXNSpUyd27NjBgQMHEBGnX/fK3O18t/EoEeFhJKWm8WjjSk6tOPTzzz9z9913M3v2bJenTh41dzvTNh51+lwqexytQZsd6ZOcLVy40KWKhTtqjlpCQnLqDd9pR3ehbdq04cSJE+zatcsXRVRO0snTPCQhIYHo6Gjat2/vUrCH7NfGoqKiKFWqFLNmzXL6XDogxvts7548PdJ0xowZFC1aNNtTIWfHmuGtebB+eZfuQjt06MDu3bs5dOiQr4qp3OSRgC8i7URkr4jsF5ERmWzvIyKxIrLV+tPfE+f1tV9++YUrV67Qvn17l187oXdDxnau43AKhsxSMOHh4XTr1s2ltI47DXrKOR9H72PjofM0/k+0Ry+sV69eZf78+XTt2pWIiAgPltix7LQJpLcv6FiR4OF2wBeRcOB/wP3ALcDDInJLJrvONMbcbv350t3z+sPixYvJmzcvrVq1cvo1ruTR7dUUu3fv7lJvHV35ynts754y8sSFdcmSJVy+fDnbK1u5w9W70Fq1alGiRAnWrFnjoxIqd3mil05jYL8x5iCAiMwAHgRCLrG3ePFi7r77biIjI51+jW0Qt5dHz6oXT3pax5U8vq585R0Z1w0OF0g1EOGhC+vMmTMpVaqUS5UKT8m42lZWRITmzZtrwA8ingj45QHbaR2PA00y2a+biEQBfwEvGmOCairIffv2sW/fPp5//nmn9nelK2ZWi4+n99b59ttviY+PJ3/+/Fme39U/XuWczO6eapQqwIe96rt9YY2Li2PBggX07duXXLmCo8d0ixYtmDdvHqdOnaJs2bL+Lo7Kgidy+Jm1Xmbs+rMAqGKMqQesACbbPZjIUyKySUQ2xcbGeqB4npGeTnF2aThX8ujOpGDSB2HNnz/fA+9GucM29fHYnZW5qWT+G9pmstMlduHChVy9etUv6ZzsSp9nR2v5wcETAf84UNHmcQXgpO0Oxphzxpj0hOBE4A57BzPGfGGMaWiMaWi70Le/LV68mFq1alG1alWn9nc1j55V/rR58+ZUrlxZ59YJAM40wGen586UKVMoX748zZo182Rxs82Zi1b9+vWJjIxk7dq1PiyZyi5P3Df+DlQXkZuAE0Av4BHbHUSkrDHmlPVhJ2C3B87rM/Hx8axatYrBgwe79DpX8uhZpWDCwsLo3bs3b731lt4+BzBXR1Wn9+F/OaoES5cuZeTIkYSFBUZvaWfan3Lnzk3Tpk21hh8k3P5mGWNSgMHAMiyBfJYxZqeIjBGRTtbdnhORnSKyDXgO6OPueX1p5cqVJCUluTwIxpmaoCt69+5NWloa06ZNc+s4yntc7RKbHlRfGPOR19ZXcJWr4ziaNm3Kn3/+qZP8BQGPVCWMMYuNMTWMMdWMMf+xPveaMeZH6+8vG2NuNcbcZoxpbYzZ44nz+srixYspUKDAdfOC+1rMpQRG/XyOJk3v4tNPP9WFUQKUs6k826CalpbGr4tnk7fy7bT7yv9/Gq5etJo2bUpaWhq///67L4upsiEw7h0DmDGGxYsX06ZNG58OhMkovSZYocVDHDp0SBtvA5gz/dltg+rVfRtIvRRDqwd7BcTgOFfbn+68804A1q1b58tiqmwIjr5ffrRz506OHj3Kq6++6pfzZ8wJ/26qkatwaR59fhRXu3Z1+XienvdF3chee8x1n701qCYkp3J54/fkKlya+i3uC5j/E1fan4oVK0bNmjU14AcBreFnwdXumJ6W8fY6X57c3NX5cRKO72bZsmUuH8/T874o52X87M/GJRJV6BwJJ/ZwT48nOHc1cNJ0rrY/3Xnnnaxfv55AnoxR6WyZWWrVqhUXL17kjz/+8FsZMs602bN+GX4Y9TDGGLZv3+5wCt10Ge8U0mU1J79yn73PPiJcKP/be+zYsYMjR464NII70EyYMIEBAwawf/9+qlWr5u/i5Gg5b7bMy6dh4j3w5b1wavs/v18+49JhLl68yNq1a7M1WZonZcwJX0g0/O9//2P//v28+eabTh1DJ1TzH3uf/ZBqsaxatYo333wzqIM9WBpuQfP4gS40c/ir34UT1juDH/pDrLXnw/LX4dw+EIEOH8DCF/75felweGgSFCx97TDLly+3LArh54BvLyfct29f3nrrLW666Sb693c8AalOqOYZ9tpAzp49y6RJk9i2bRtlypShU6dONG/eHBHJ9LPPlRTPmFEv07BhQ5588kmHxw4Gt956KwUKFGDdunU89thj/i6OsiO0Av7YUpCSoUdErE03tz+n//O77YXgh/5w9q8bLggL33+WopG5aHJLFa8X3RXpgeH99z7k1KlTPP3005w4cYJXXnnF4RwsOqGa+zIbjLRnzx46dOjAwYMHKV++PDExMYwfP56oqCjee+89qtSqx+Ltp+jaoDxPNKvK5DV7+eaVJzgXe5ZJ02cTHh5u99jBIjw8nMaNG7N+/Xp/F0U5EFo5/MunYeFQ+GsJGPcawFKK1aT0iE10qJ6Lb1/vl/mdQc9p190R+IrtSlYv31eVAQMGMHXqVBo0aMAHH3xAVFSUz8sU6uzl4XMlxXFp6rOICPPnz+fOO+/k8uXLfPvtt7zxxhvExsZSq2kbLlRqQa+2LXiwimH48OFs2ryZkg+O4KnHH2b25uMh0b4yatQoxo0bx8WLF52a4E95h6McfmgFfIAFL8Lmr90+98+HUrj72yt83yMfXWvn/mdDyVr/3BnUe9inFwJHDa9jb4tjyJAhHD9+nH79+vH+++9TuHBhj5chp4q5lJDpjKbnlv4fM6Z+y5YtW6hXr951r6k+7Htif/ueS5vmYZKuXns+vEAxit7zFPlr/TOQL0wsUyxnnC01mFI76Uszrlq1ipYtW7r8+mBOaQWSnNVoGx8DRSrDrV2gYFmQcChQFopWcekwc/ekkDcXtK2WIUWSMUV0YhMc/92SFkr/ffnr1zcaf3P/P/+62HBsy1HDa/fu3dm7dy8jRoxg0qRJNGrUiKNHb1ykQ2VPZnn4S4d3Mm3yN7z44os3BHuAX1/twOPPDuPmIdMp2XUUpdoN4u6BY/nXB/MpXtdyF5b+f9i5fvmgb19xdwCWdhn2vtDK4QP0sjPPzIxHwRgo3wCOroe4GMhfyjK5c+JliCgIcZb53YwxzNuTzH3VcpE/wsm1ax21FZz9y9pmsBcmRMGjc7JsMM5MVg2vkZGRvP3227Rv356OHTsSFRXFmjVrqFixosPjKudkbAOZ+uZ7lCxZktdffz3T/dP/v5LJRdHad5GUmkbTxpUwQOKBi9f9H8aGQPtK8eLFqV69ust5fFcnnFPZF3opneya8Sic3g7lG7Bhzc/c+X9H+aZHGfrcVQouHPbeeUvWslwICpS+8UKQSYro6SmbKFkw73WBIbNBMZs3b6Z169bUqVOH1atXkzt37hv2Udl3/PhxKleuzPDhw3n77bft7pfZ/xfg1P9hMPrXv/7F0qVLOX36NCLOVZbspcuCLaUVKByldEKvhp9dNncGU1YPJm/er+jyxR5YMijzO4PceTxzIUi/M4g7DRNsJmez0510QocPYOHzsFgY66Ct4I477mDixIn06tWLUaNG8c4777hfVnXNxIkTMcbw1FNPOdwvq2mvQ2k1sphLCexIKU1MTAyHDh3y2toRKvs04GeQnJzMjBkz6NSpk6XR09UUkacvBGC/O2nGcQVLh0O7d6+liHr27El0dDTjx4/nkUce4bbbbsvytNpwlrXU1FS+/PJL2rVrx0033eTv4gSMj6P3cTqPJX24bt06pwM+aJdhX9GUTgYLFiygU6dOLFiwgI4dO7p+AJvUEEfXW9oHwvNYuokm/O35AqcrWcvSVlCixnUpovMzn6Hmq+upfWtdVj9VEuk+2WFbgW2Xz2DrC+4ra9asISoqipkzZ9KjRw9/F8fvbHPwJi2VYx/2pEDdeyl7/yDNwftBzuqW6aZu3brxyy+/cPLkSc/mvWc8agnCZ/fByS2WRmIB4mMhLcVz58nEl1uSeHJBAjMfykePJhUzbTRuduBxTqQUuuG12nB2o7w8D4kAACAASURBVKFDh/LJJ59w9uxZChYs6O/i+F3GHHzsjJEUCEtm+7YtepfoB5rDd9Lhw4eZN28ew4YN83wjp6PUUGYXAhdTRIbMV5MH6Fc/Nx+sT+KN1Yk8dMspwm5oK9jLL4UP8F7J/9D20DiMgTfMk3yYfxLli0bC5QZ+GWAWiIwxzJs3j3vvvVeDvVXGHHzucrU4u/EHCoTfOGZE+ZcGfBv/+9//EBGeeeYZ353U3oUgnYO2AnPhsCXSW6XxT9C37SARJsJrUXno9f1V5uxKocetNhcza3tAePwZRsT3txxO4F0+pkrCCeQUWbYV5KSLwY4dOzh48CAjRozwd1ECim0O/g1zkFnrZrFp0yaioqK0XSiAaErHKi4ujgoVKtC2bVtmzpzpk3O6ZcajnD+wmV+vVqJJrn3kM1dINLkJlzSKiGVtUdsaf2qaoe5n8YQJ/DkwP2FOdpm7gZ22guyMKwhGY8eO5bXXXuPkyZOUKVPmum0a2CzOnTtHyZIleeONN3j11Ve1XcjHNIfvhDFjxvD666+zYcMGGjdu7JNzZpe9KRYAPs/9AUVKVeDOguduaCuYvu0qj/xwlVkP5aP7rV7ql+9oXEEIXAiioqK4evVqpuu3amD7R8OGDdkVk0CpR27sDqztQt6lAT8LZ86coVq1arRr1445c+Z4/XzuythIFiZQqVgkY7vUYemOM5kP5JnxKKn5SlJn4FfkSktg25CqhIWLTxqNgZC4EMTFxVG0aFGGDh3KuHHjrj2vi8vcaOTIkbz33ns8MWElqw7F6YAqH8pZc+lkwyuvvEJiYqLDEZOBJGMjmQGa31yC5jeXtL8cXa9phD/4Ia+On8COMyn8UPU/MHQP1GgHDZ+AKlEQUcAy75AbcxDZFbsHMP8MMLOdg+jIOsuUE7aL1Xhg7iFPW7NmDSkpKdxzzz3XP6+Ly9zgvvvuIyUlhXP7/rj2PU1ITmPdgXP+LlqOluMbbefNm8dXX33FsGHDqF69ur+L47TsDlTp2bMno0ePZty4cXTr1g1xtdHY0+MKHI00zmSNAn/eGURHRxMREUGzZs2ue15Hit6oadOm5M+fn12b1vLoM3fzSONKPD/jD/bFxAXlfP+hIkendA4ePEijRo2oUqUK69atIyIiwmvnCiQTJ07kqaeeYsWKFTfUVp3mj3EFtlNT+yFFdPvtt1OsWDFWrlx5wzZn5zjKSTp27MiePXsI6/kxSak3xpmcnPLyJs3hZ+LQoUO0atWKuLg41q1bR40aNbxynkCUmJjITTfdxK233sry5cs9e3A/DjADvHYhOHfuHCVKlODNN99k1KhRni93CPriiy94+umniV6znnnHI3RyNB/xeg5fRNqJyF4R2S8iN3RQFpE8IjLTun2DiFTxxHmza+HChddWJlqxYkWOCvYAefLk4YUXXmDFihVs3rzZswfvNQ06vg99FsDIE/DSHsdtBWEezip6qa3g119/BcjWwh45VdeuXQkPD2f5onma8goQbtfwRSQc+AtoAxwHfgceNsbsstlnEFDPGDNARHoBXYwxPbM6tidr+ImJiURHR/PRRx/x008/Ua9ePaZPn84tt9zikeMHm0uXLlGpUiXuu+8+Zs2a5b+C2LsjyLBGgdekjyuo29Ph6mX//ve/+eCDD7h48SL58uXzbplCSLt27di7dy9t3phFqUL5NOXlA15N6YhIU2C0Maat9fHLAMaYt232WWbdZ52I5AJOAyVNFifPTsA3xjB79mxiYmKIiYnhzJkz7Nmzh82bNxMfH0/p0qUZMmQIzz//PHny5HHx3YaWkSNH8s4777Bnz57AbLDOOBGd7aI1vmorsC5j2eydzZgiVfjt6eJB153UnyZNmkTfvn1Zv349TZo08XdxAlpqaioxMTFcvHiRlJQU6tTJ3tTZ3g74DwHtjDH9rY97A02MMYNt9tlh3ee49fEB6z5nMzneU8BTAJUqVbrjyJEjLpepQIECxMfHExYWdm0VngYNGnD//fdz9913kzev3kqCZfxB5cqV6du3L5999tkN2wN65KgP2woSUgyFx13m+dZleLfZFcuTITCuwBf+/vtvypUrx8MPP8xXX33l7+IEDGMM69atY+HChaxbt45Dhw5x4sQJUlIs390yZcpw6lT27m69PXlaZmP0M15FnNnH8qQxXwBfgKWGn50CbdmyhaJFi1KsWDHCw8Ozc4gcoXTp0jz22GNMnjyZsWPHUrx48eu2264xGnDd6FydjM6NC8Gmk6kkpUKz4hcB6whlhwvXuLeUZSgpUqQIffv2ZeLEibz55puUK1fO30Xyu4ULF/Lvf/+bXbt2kStXLho0aECLFi2oWLEiFSpUoGjRohQpUsQr5w65lI5yzY4dO6hbty5vvfUWL7/8MhCiI0fdaCsYtzaRl6MTiXmpACXzZ7Ofg5NtBaHowIED1KhRg2HDhl03QjmnSUhIoH///kybNo3atWvz0ksv0b17d4/PuurtlE4uLI229wAnsDTaPmKM2WmzzzNAXZtG267GmCxXjtCA7xv33XcfO3fu5PDhw+TOnTvnrTFq01aQemQdxtpWkCsiL1w4zAPTr7DvXBp7Bhfw7HkzaSsI1QtBz549WbJkCbt376Z8+fL+Lo7PxcXF8cADD7Bq1SreeOMNRowY4bVxP17tlmmMSQEGA8uA3cAsY8xOERkjIp2su30FFBeR/cAQQOeWDSDPPvssJ0+eZMGCBUAOHDnaaxq88Cd0n8Tr1eZQPXEqo2+eA6XrkFaoEr+eCKN5tYL/TDfhqe6kGZextO1Cmv778tev70Ka/nsATTnhjLfeeouUlBQGDhxIII/98QZjDH379uWXX35hypQpvPbaa34b5JljB16pf6SkpFwbiLV06VIg540ctTsD6YXjHPliAN988w19+vT553l/jzS2d0cQwG0F//3vf3nppZf48ssveeKJJ4AA7xjgIR988AFDhgzh3XffZdiwYV4/n460VVkaPXo0Y8aM4cCBAzlyYW57aayKMb8x7PnB/PXXX851XfXHuIKMU04EaFtBamoqbdu2ZdWqVcyZM4fOnTuH/JTShw8fplatWrRr1465c+ci2V2HwgUa8FWWjh07RpUqVRg5ciRvvvmmv4vjF6/M3c53G48SER5GUmoajzauxNG577Fs2TJOnz7t/h+rvXEFTi5jmW0B1FZw+fJl2rRpw4bfN1HsnqcoUL/9dZ9rUHcMyESPHj1YuHAhe/fupWLFij45pwZ85ZT77ruPAwcOsH//fp/URAJNZmmsFaN7ctttt/HDDz9478QheCFwlKr5+++/6d7rEVYsW0KhuvdQuM0gIiPzhVzHgN9++41mzZoxevRoXn/9dZ+dVwO+cso333xDv379gmLVL184deoU5cqVY/z48QwdOtT3BQjiC0FWqZq0tDRaPTKYNTM/I0/papToMpI+9zUKqbTOgw8+yG+//caRI0eIjIz02Xm9PfBKBQFnGse6dOnCgAEDmD59ugZ8YO3atQC0aNHCPwVwNLgss4XtPdVWkLH3ULof+v+zbfnrcPGIZTF7mwbjPz7rgwGWJQ3BUISpG44ydcPRG1I1YWFh1O7Qj7LVbmXJJ69wfuoQthUZByES8Pft28eCBQsYNWqUT4N9VrSGn0M42zjWpUsXNmzYwLFjx3L8KOXnn3+eiRMncvHiRXLn9tIawN7gxzsDY70gzE2LogonERGW3fRvhiR+SkR4eKZ3Bvv37+fBBx/k0KFDLFq0iNatg3+lsMGDBzNx4kSOHDlyw2L33qYpnRzM1VGzM2bM4OGHH+a3336jadOmvihiwLrjjjsoXLhwpgueBCU/XAiMgZi8VSidaD2+nRRR7D0f0fqBnhw6dIhff/2V22+//brjBFP3zStXrlC6dGm6du3K5MmTfX5+XdM2B3NmvdWYSwn0mLCOmMsJtGvXjly5cl0bhJVTXb58ma1bt9K8efOsdw4WNgPMGLoHXj9vWa+gdB0oUhlu7eLx9YxF+CfYg90BZiX/+D9W9ClCsTypdOnUgfMfRl03wMx2XqdA9+OPPxIXF0ffvn39XZQbaA4/xDkzajbjJGktWrRgwYIFvPXWW34suX+tX7+etLS00Ar49rjaVuCpO4IMbQVlgDldw4mafIo+n8Uwv1c+5r7Xn/LEsCnpX3wf8RX8Ae02PMGYiMk0HvZjwA0uA5g6dSoVKlQgKirK30W5gQb8HMDegucZ0z3pDWxXwqsRu+NnDh8+TJUqVfxUav9au3YtYWFh3Hnnnf4uiv84uhBUu+fGwWUeuCA0qZCLt++OYOhPiUzbnsxj9X4BYHGel69Nuft1oQmUTToSkDOSxsbGsmzZMoYMGUJYWOAlUDSHn4PZG136cM3cNG1Ql//7v/9j8ODBWR8oBN1zzz38/fffnl8CMidws60gNc3Q4psr7Dmbyp7BBSjl7AyljtYo8NEAs88//5yBAweybds26tWr57XzOKLdMpVd6w6cvSHdc2f9OlSvXp0lS5bkyICfnJzM+vXr6d+/v7+LEpzcTBGFhwlfdcpLvc/jee3nRD7vmA9D5otqXMfhGgU23Um9ONJ4/vz53HzzzdStG5jdSzXg52AfR+8j9nISNUoV4MNe9a9L99x7771MmTKF5OTk4OqS6AFbt27lypUrOSN/70suXAhq31SWQc3P8smaczzTKIK6pd3oIuzGuAJXUkSXL19m5cqVDB48OGBHqmvAz4Ey5u7/iomj/cdrruuqee+99/LZZ5+xceNGmjVr5q+i+kX6gKuc9r79xs6F4PUiDzFly0KGrY1k6cO5PT8jaWYXAjdWL1u+fDlJSUl06tSJQKUBPwdaM7y13QVO0rVq1QoRYcWKFTku8K1du5aqVavqcnx+Vqz/HEacf5d///vf/NbqV+666y7LBl9NTe3iMpY/Ls9P0fy5aVbvZs+VwcMCrxlZeZ0zXTWLFSvGHXfcQXR0tB9L6nvGGNauXavpnADxzDPPULJkSUaPHn3tuZj2X9HjRHdius2GkScsYwmG7oEa7aDhE1AlCiIK/LNYjQfHFQDWC4H550JwYhNpxzayaPFi2leFXF/dff1iNae2wzf3B8SiNRrwc6j0rppzBzXj0SaViY1LvGGfe+65h3Xr1hEXF+eHEvrHvn37iImJue6uxnZgmvKt/PnzM3z4cJYvX866desAB4Owek2Dju9DnwXXXwh8MMBs2+k0zsal0LZa+HUXgmsDzI6ss9wRpAd/P10QtFumsuunn36ibdu2LFu2jPvuu8/fxfGJ9G51tguehPoiHYEuPj6eihUrklyqNsU7j7xhu9tz6HsgRfTf3xJ5aXkiJ4YUoFxBJ+rRGRetyaw7aTZ7Dmm3TJUtd911F+Hh4fzyyy8hHfBt52lZsWIFlSpV4uabb7Y7MC3UFukIdPnz52fQoEG89dZbdCmdwsbzEXbbnrLFUe8hJy8E0YdSqVUizLlgD9c3GNtrK1j9juWOxYM04Cu7ChQowB133MHq1av9XRSvSk8RfLhsDytXrqRLly6IiFON28o3Bg8ezHvvvcfOZd+RWP9xu21PHuXkhSAprAC/HN1Hn9s9vDD5pq8sP7nywKgYjxxSA75yqGXLlnz00UdcvXqVfPny+bs4HpWxBv/NglVcuHCBxedLAM41bivfKFOmDI8++ihTpk3n+d4v0K/1rdeNG/GpDBeCjWvXEp/UgnuaN4aGDT3Xe0jCoWZ76PBfz5QbbbRVWYiKiiIpKYkNGzb4uygel3Em0ZRj2wBYPn7QtX2cadxWnmWvkXzQoEGkJCVQ5cJmbilXiLGd6zChd6apap+Kjo4mLCyMVqPmZ95obNt7qGQtyFf8+l5EYXbq3SYVCpTy6FQQWsNXDjVv3hwRYfXq1bRq1crfxfGojDX4Mwe2UKpydepUq3xtH9uAMrZzHX8UMyQ5mt8+4+yt6Ro2bEjDhg357LPPeOaZZwJmNGt0dDQNGjSgaNGime9gLzWULrO2gkpN4OQfEOfZnjsa8JVDRYoU4bbbbuOXX37xd1G8Ir0G36FGQZq9vZNyHXr7u0g5QmZB3ZlG8kGDBtGvXz/Wrl3rv6UnbcTHx7N+/XqGDBmS/YNkdUHwIE3pqCy1bNmSdevWkZSU5O+ieNyE3g0Z27kOh7b+iklL5bORT/u7SCGt5qglVBmxiKkbjmKMJahXGbGImqOWOLVYT8+ePSlQoIBfVpLKzNq1a0lOTubuu+/2d1Gc4lbAF5FiIrJcRPZZ/830nkZEUkVkq/XnR3fOqXwvKiqKq1ev4s8xEd4e/PTjjz9SunTp6xZv1wFXnucoqDvTSB4ZGUm3bt2YPXs2V69e9dfbuCY6OpqIiIigGZntbg1/BBBtjKkORFsfZ+aqMeZ260/gziykMpV+6+zP7pneXOIuKSmJJUuW8MADD1y3aEUwLasXLLIK6s40kvfu3ZtLly4FxDKc0dHRNG3alMjISH8XxSlujbQVkb1AK2PMKREpC6wyxtTMZL84Y0wBV4+vI20Dx6233kqlSpVYsmSJU/t7atHprBZh98R5lixZQvv27fnxxx954IEHXF74Xbnm6SmbKFkw73UrsLnS2yY1NZXKlStTv359vwb98+fPU6JECd544w1effVVv5UjI28uYl7aGHMKwPpvKTv75RWRTSKyXkQ6OzqgiDxl3XdTbGysm8VTntKyZUvWrl1LSopz/Yk9VTvOKq/rifNMmjSJ4sWL07ZtW6fOqdyT3m6S3a6V4eHhPPLIIyxduhR/xojVq1djjAma/D04EfBFZIWI7Mjk50EXzlPJesV5BPhQRKrZ29EY84UxpqExpmHJkiVdOIXypqioKOLi4ti6davD/Rw1ymWHvRRAi3d+9sh5Lly4wLx583jkkUeIiIhweE4dcBU4evfuTUpKCjNmzPBbGX7++WciIyNp1KiR38rgqiwDvjHmXmNMnUx+5gNnrKkcrP9mOv7XGHPS+u9BYBVQ32PvQPlEVFQUkHUe3xu148zyup46z4wZM0hKSqJPnz5ZnlMFjrp163LbbbcxZcoUv5Vh5cqVtGjR4lpFIRi42w//R+BfwDjrv/Mz7mDtuXPFGJMoIiWAZsC7bp5X+Vi5cuW4+eab+eWXXxg6dKjd/bxRO7Y3+MneeZzN6xtjmDBhAnXr1qV+/evrIDrgKvD17t2bl156ib1791Kz5g1Nh1515swZdu7cSe/ewTVuw90c/jigjYjsA9pYHyMiDUXkS+s+tYFNIrIN+BkYZ4zZ5eZ5lR+0bNmSNWvWkJZ2Y4OmLV/Vju2dx9m8/o8//si2bdsYOnRowIzaVNdz1DX2kUceQUSYPn16Jq/0rlWrVgHQunVwtevofPgqS+k15ih28eyA/mzdupXbbrvNp+d2pheOo941a4a3vu44xhgaNGjA5cuX2bNnD7ly6aDzQJTVWgQtW7bk7Nmz/Lxus0d6hTlrwIABTJ8+nXPnzgXcd8ebvXRUDpBeY95LBQCfTrPgSi+cjHn9PLmE4vkjmPvMXTccZ9KkSWzdupVXX3014P5glfON/927d2fXrl28OmmpT8dMrFy5kqioqKD77mgNX9mVWY35+Gd9yVe2Opf3/Orzc0PWfeFfmbud7zYeJSI8LNPXAyTFHuH0t0OIanYn0dHRhIeHe6zcyjNiLiXYXYvAtgZf7flpHPy4N4WbPUyR5o9ce96bYyaOHz9OxYoVef/993nxxRe9cg53aA1fZUtmPWFqNriLsNM7ne6P78lzO+qFc+DAAV577TUmjerH6Wkvc/yHcVzeupTkv09ft1/aqd3E/fgmxYsWZvr06RrsA5Szjf/r3uxGuVq3c/UvSwXEF2Mmfv75ZyD48vegs2UqBzL7o2vQsAW7Vs1n/fr1Xp0/xNk/+LS0NMaNG8eYMWNITk6mfv36VC5amD937+H8bkvqKVehUuQqVh5z9RKJZw5SpHR5li6aR9myZb1WfuW+9EZ52xG5GZUqlJdbm7Vl+Vfj4O/jJBat4PUxEytXrqRYsWLUq1fPa+fwFg34yqGMf3THT0cSHh7OkiVLvD5hVFZ/8MYYBg8ezGeffUa3bt34+OOPKVeuHAAjf/iTyUt+I/noVuKP7iJXfAx1alYivHVbqrXuwR133OHVsiv3Ods1tlS9KJB36FjwKEWaNPPqKljGGFauXEmrVq2um3cpWGgOX7ksfdTtli1b/FqOUaNG8Z///Idhw4bxzjvvXNe10t35WlRwadGiBX///Tfbt2/36nn27dtHjRo1+OSTT3jmmWe8eq7scpTDxxgTsD933HGHUYHnrbfeMoA5efKk38rw008/GcA88cQTJi0tzW/lUIHho48+MoDZvXu3V8/z4YcfGsAcOHDAq+dxB7DJ2ImpwXdPovyuY8eOAMybN88v579w4QKPP/44tWvX5uOPP9ZBU4pu3boBMHv2bK+eZ/HixdSqVYuqVat69TzeogFfuaxOnTrUrH0Lr/73c78sDvLaa68RExPDtGnTgmYecuVd5cuXp1mzZl4N+PHx8axatYr27dt77RzepgFfuUxEKFv/Hs4d+JMx363y6bm3b9/Op59+yoABA26Y/0blbN27d2f79u3s3bvXK8dfuXIlSUlJGvBVzpE+AvKvgpapFaZNn+HW9MeuGjZsGEWKFOHNN9/0yflU8EhP63wzdbpXlqZcsGABBQoUCJrlDDOjAV+5JH1AVMGS5chTvjbxfy7ngXqlfbI4yLp161i2bBkjRoygWLFiXj+fCi4VKlTgrrvu4psp33l8moXk5GS+//57HnjgAfLkyeOx4/qaBnzlEtsBUcXu7ELyhZMc37zSJxNWvfHGG5QoUYJBgwbdsE0XHFc1Ry1hd2RdYo7sIzHmsNuL79iKjo7m/PnztOvUNai/ZxrwlcvSB0T99OEwSlSoyupZX2Q5ZTK4F5TTa/fDhw8nf/78N2zPzlKHepEILWuGt6Zb9x4QFk78jpUenWZhxowZFC5cmF1hNwX1wvYa8JXL0tckrVOhCB+OG8OF4weYPHlylq9zZ/1Ze7V7d5ZU9NS6uyowlCqUl1IlS5KvakPid60iISnZ6WkWHF38ExISmDJjNikVGzFjy2mPLN3pLxrwlVt69epFy5YtefbZZ9mzZ0+m+9gLyjeNWORU7dpR7T47Sx16et1dFTjOxiXSvmtPUuPO0zTvKacX33F08Z85cyZpiVdo82C3oF/YXgO+cknGmlB4eDjTpk0jX758PPDAA+zadeNiZpkF5SrFI0FwqnbtKHefnSUVvbHurvKPjN/HCb0bMm3MIIoXL07Sjp+ynE7D0cU/5lIC3T//jf9+8CG33HILtRvcFfQL22vAVy7JrCZUvnx55s+fz6VLl2jcuDFjxowhNjb22nbboAyQkJzG4XNXnKpdZ5W7B9eXVPTGurvKPzL7PubJk4f+/fszb948jhw54vD1ji7+H0fvY+3atWzftpXnnnuOc/FJQb+wvU6eppzizIIkJ06cYMCAASxcuJDcuXNz//33M3DgQNq2bcuAqZspWTAv7W4tw6h52zl6/gppBrsLW6Rr164dmzdv5vDhw3YDfnbo5GrBLavv49GjR7npppsYNmwY48aNc3gs20VzklLTCANSrWExZs4bJJ7YTfmBk8gXGem1RVU8SRdAUW5zJg1Svnx5FixYwK5du3juuefYuHEj999/P40aNWJQvdyM7VyH5tVL0OzmEhjIsnb966+/Zlm7z670hudbyhVibOc6GuyDTFbfx0qVKtG5c2e++OILLl265PBYGe8QW1QvQafby5F6bCtXD/xOsbu606Vx1ZBI+WnAV05xJQ1Su3Ztxo8fz5EjR/j66685fvw4DRs25H//+x/gXArGGMPQoUMpW7Zsprl7lbM5830cMWIEFy5cYPz48Q6PlfHiP6lfEyLDDWd++oLcRcuSv0GnkEn56QIoymnOrEBkKyIigr59+9KpUyf69u3L4MGDOXLkCJ/bzF1vb2GL2bNns2HDBr766iuP1+5VaMjq+9ioUSN69OjBf//7XwYOHOjSCmcLJ75L8tmj/N830zld5GavLqriU/bmTQ6EH50PP3SkpKSYgQMHGsA8/fTTJjU11e6+58+fNxUqVDB169Y1KSkpPiylCjX79+83uXPnNt26dXN63YTPPvvMAGbo0KFeLp134GA+fL8HdUc/GvBDS1pamhkxYoQBTJ8+fewG84cfftjkypXL/P777z4uoQpF77zzjgHMBx984HC/1NRU89prrxnA3H///SY5OdlHJfQsDfgqYKSlpZk33njDAKZHjx7m8uXL120bM2aMAczYsWP9WEoVStLS0kznzp1NeHi4ee+9926o6aelpZkVK1aYO+64wwCmb9++JjEx0U+ldZ/XAj7QHdgJpAENHezXDtgL7AdGOHt8Dfih67333jMiYm666SYzYcIEs2jRItOrVy8DmMceeyxoa1cqMF2+fNl069bNAOb22283o0ePNu+//74ZNGiQqV69ugFM+fLl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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "best_beta, best_coff = 1., 1.\n",
    "best_mse = 1e8\n",
    "for beta in [0.1, 1]:\n",
    "    for coff in [0.1, 1., 10.]:\n",
    "        # 5-fold cross validation\n",
    "        max_fold = 5\n",
    "        mse = []\n",
    "        for i in range(max_fold):\n",
    "\n",
    "            ##TODO: calculate the index of the training/testing partition within 5 fold CV.\n",
    "            # (hint: set trnIdx to be these index with idx%max_fold!=i, and testIdx with idx%max_fold==i)\n",
    "            trnIdx = []\n",
    "            testIdx = []\n",
    "\n",
    "            for j in range(xTrain.shape[0]):\n",
    "                if j % max_fold != i:\n",
    "                    trnIdx.append(j)\n",
    "\n",
    "            for j in range(xTrain.shape[0]):\n",
    "                if j % max_fold == i:\n",
    "                    testIdx.append(j)\n",
    "\n",
    "            i_xTrain, i_yTrain = xTrain[trnIdx], yTrain[trnIdx]\n",
    "            i_xValid, i_yValid = xTrain[testIdx], yTrain[testIdx]\n",
    "\n",
    "\n",
    "            ##TODO: run kernel regression on (i_xTrain, i_yTrain) and calculate the mean square error on (i_xValid, i_yValid)h_med = median_distance(i_xTrain)\n",
    "            h = coff * h_med\n",
    "            i_yPred = kernel_regression_fit_and_predict(i_xTrain, i_yTrain, i_xValid, h, beta)\n",
    "            mse.append((i_yValid - i_yPred)**2)\n",
    "\n",
    "        mse = np.mean(mse)\n",
    "\n",
    "        # keep track of the combination with the best MSE\n",
    "        if mse < best_mse:\n",
    "            best_beta, best_coff = beta, coff\n",
    "            best_mse = mse\n",
    "\n",
    "print('Beta beta', best_beta, 'Best bandwith', '{}*h_med'.format(best_coff), 'mse', best_mse)\n",
    "\n",
    "# bandwith\n",
    "h = best_coff * median_distance(xTrain)\n",
    "yHatk_i = kernel_regression_fit_and_predict(xTrain, yTrain, xTest, h, best_beta)\n",
    "\n",
    "# visulization\n",
    "plt.plot(xTrain, yTrain, '*')\n",
    "plt.plot(xTest, yHat, '*')\n",
    "plt.plot(xTest, yHatk_i, '-k')\n",
    "plt.title('beta {}, handwidth {}h_med'.format(best_beta, best_coff))\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "pycharm": {
     "name": "#%%\n"
    }
   },
   "outputs": [],
   "source": [
    "\n"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.6"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 1
}
